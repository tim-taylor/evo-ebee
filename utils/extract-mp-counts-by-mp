#!/bin/bash
#
# Simple utility to extract flower marker point counts
# from an output log file generated by evobee when used
# with log-flag 'm' (FlowerMPsInterPhaseSummary)
#
# Outputs one CSV file for each marker point in the range
# 300 to 650nm. Each file contains a count of plants of that
# marker point at each generation.

if [ "$#" -ne "1" ]; then
    echo "usage: extract-mp-counts-by-mp logfile"
    exit
fi

LOGFILE=$1
MPMIN=300
MPMAX=650

for M in `seq $MPMIN 10 $MPMAX`
do
  gawk -F',' -vM=$M '($1=="m" && $4==M) {print $2 "," $5}' $LOGFILE > mp-counts-mp-$M.csv
done
